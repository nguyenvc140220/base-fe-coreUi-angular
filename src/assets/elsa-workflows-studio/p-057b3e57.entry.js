import{r as s,h as e}from"./p-ee0b9025.js";import{S as t}from"./p-f3f2f442.js";import{T as l}from"./p-6b50e59c.js";import{i as o,I as a,a as i}from"./p-39869623.js";import"./p-83f217d4.js";let r=class{constructor(e){s(this,e),this.jsonToDictionary=s=>{if(!s)return[["",""]];const e=JSON.parse(s);return Object.keys(e).map((s=>[s,e[s]]))},this.dictionaryToJson=s=>{const e=this.removeInvalidKeys(s);return 0===e.length?null:JSON.stringify(Object.fromEntries(e))},this.removeInvalidKeys=s=>{const e=[];return s.forEach((s=>{const t=s[0].trim();""===t||e.some((s=>s[0].trim()===t))||e.push(s)})),e},this.onRowAdded=()=>{this.currentValue=[...this.currentValue,["",""]]},this.onRowDeleted=s=>{const e=this.currentValue.filter(((e,t)=>t!==s));0===e.length&&e.push(["",""]),this.currentValue=e,this.propertyModel.expressions[t.Json]=this.dictionaryToJson(e)}}async componentWillLoad(){this.currentValue=this.jsonToDictionary(this.propertyModel.expressions[t.Json]||null),0===this.currentValue.length&&(this.currentValue=[["",""]])}onDefaultSyntaxValueChanged(s){this.currentValue=this.jsonToDictionary(s.detail)}onKeyChanged(s,e){this.currentValue[e][0]=s.currentTarget.value,this.propertyModel.expressions[t.Json]=this.dictionaryToJson(this.currentValue)}onValueChanged(s,e){this.currentValue[e][1]=s.currentTarget.value,this.propertyModel.expressions[t.Json]=this.dictionaryToJson(this.currentValue)}render(){const s=this.propertyDescriptor,t=s.name,l=this.currentValue;return e("elsa-property-editor",{propertyDescriptor:s,propertyModel:this.propertyModel,activityModel:this.activityModel,onDefaultSyntaxValueChanged:s=>this.onDefaultSyntaxValueChanged(s),"single-line":!0},l.map(((s,r)=>{const n=`${t}_${r}_key}`,h=`${t}_${r}_value}`,[u,d]=s,c=r===l.length-1;return e("div",{class:"elsa-flex elsa-flex-row elsa-justify-between elsa-mb-2"},e("input",{id:n,type:"text",value:u,onChange:s=>this.onKeyChanged(s,r),placeholder:"Name",class:"disabled:elsa-opacity-50 disabled:elsa-cursor-not-allowed focus:elsa-ring-blue-500 focus:elsa-border-blue-500 elsa-border-gray-300 sm:elsa-text-sm elsa-rounded-md elsa-w-5/12"}),e("input",{id:h,type:"text",value:d,onChange:s=>this.onValueChanged(s,r),placeholder:"Value",class:"disabled:elsa-opacity-50 disabled:elsa-cursor-not-allowed focus:elsa-ring-blue-500 focus:elsa-border-blue-500 elsa-border-gray-300 sm:elsa-text-sm elsa-rounded-md elsa-w-5/12"}),e("div",{class:"elsa-flex elsa-flex-row elsa-justify-between elsa-w-24"},e("button",{type:"button",onClick:()=>this.onRowDeleted(r)},o.getIcon(a.TrashBinOutline,{color:i.Gray,hoverColor:i.Red})),c&&e("button",{type:"button",onClick:this.onRowAdded},o.getIcon(a.Plus,{color:i.Gray,hoverColor:i.Green}))))})))}};l.injectProps(r,["serverUrl"]);export{r as elsa_dictionary_property}