import{r as e,h as t}from"./p-ee0b9025.js";import{e as a}from"./p-d17a08e5.js";import"./p-f3f2f442.js";import{E as i}from"./p-9f020d74.js";import"./p-f1ec68ec.js";import"./p-a3b5bd35.js";import"./p-6f3ac5fa.js";import"./p-82db2ff5.js";import"./p-949334ec.js";import{p as s}from"./p-6aecc542.js";import{a as o}from"./p-e5205878.js";import{F as n,s as r,c as l,t as c,a as m,b as p}from"./p-1fc2211d.js";import{l as h}from"./p-62312a9a.js";import"./p-80de33dc.js";const d={en:{default:{Buttons:{Save:"Save",Cancel:"Cancel"},Tabs:{Properties:{Name:"Properties"},Common:{Name:"Common",Fields:{Name:{Label:"Name",Hint:"The technical name of the activity."},DisplayName:{Label:"Display Name",Hint:"The friendly name of the activity."},Description:{Label:"Description",Hint:"A custom description for this activity."}}},Storage:{Name:"Storage"}}}},"zh-CN":{default:{Buttons:{Save:"保存",Cancel:"取消"},Tabs:{Properties:{Name:"属性"},Common:{Name:"通用",Fields:{Name:{Label:"名称",Hint:"该活动的技术名称。"},DisplayName:{Label:"展示名称",Hint:"该活动的呈现名称。"},Description:{Label:"描述",Hint:"对这项活动的自定义描述。"}}},Storage:{Name:"储存"}}}},"nl-NL":{default:{Buttons:{Save:"Opslaan",Cancel:"Annuleren"},Tabs:{Properties:{Name:"Eigenschappen"},Common:{Name:"Algemeen",Fields:{Name:{Label:"Naam",Hint:"De technische naam van de activity."},DisplayName:{Label:"Weergave Naam",Hint:"De gebruikersvriendelijke naam van de activity."},Description:{Label:"Omschrijving",Hint:"Een aangepaste omschrijving van de activity."}}},Storage:{Name:"Opslag"}}}},"fa-IR":{default:{Buttons:{Save:"ذخیره",Cancel:"لغو"},Tabs:{Properties:{Name:"ویژگیها"},Common:{Name:"عمومی",Fields:{Name:{Label:"نام",Hint:"نام سیستمی Activity"},DisplayName:{Label:"عنوان نمایشی",Hint:"عنوانی که Acitvity را توضیح میدهد"},Description:{Label:"توضیحات",Hint:"توضیحات این Activity"}}},Storage:{Name:"Storage"}}}},"de-DE":{default:{Buttons:{Save:"Speichern",Cancel:"Abbrechen"},Tabs:{Properties:{Name:"Eigenschaften"},Common:{Name:"Allgemein",Fields:{Name:{Label:"Name",Hint:"Der technische Name der Aktivität"},DisplayName:{Label:"Anzeigename",Hint:"Der freundliche Name der Aktivität"},Description:{Label:"Beschreibung",Hint:"Eine individuelle Beschreibung der Aktivität"}}},Storage:{Name:"Speicherort"}}}}};let b=class{constructor(t){e(this,t),this.workflowStorageDescriptors=[],this.renderProps={},this.updateCounter=0,this.timestamp=new Date,this.t=e=>this.i18next.t(e),this.onShowActivityEditor=async e=>{this.activityModel=e,this.activityDescriptor=o.activityDescriptors.find((t=>t.type==e.type)),this.workflowStorageDescriptors=o.workflowStorageDescriptors,this.formContext=new n(this.activityModel,(e=>this.activityModel=e)),this.timestamp=new Date,this.renderProps={},this.updateCounter++},this.onChange=async()=>{const e=new FormData(this.formElement);this.updateActivity(e),await a.emit(i.UpdateActivity,this,this.activityModel)}}connectedCallback(){a.on(i.ActivityEditor.Show,this.onShowActivityEditor)}disconnectedCallback(){a.detach(i.ActivityEditor.Show,this.onShowActivityEditor)}async componentWillLoad(){this.i18next=await h(this.culture,d)}updateActivity(e){const t=this.activityModel,a=this.activityDescriptor.inputProperties;for(const i of a)s.update(t,i,e)}async componentWillRender(){const e=this.activityDescriptor||{displayName:"",type:"",outcomes:[],category:"",traits:0,browsable:!1,inputProperties:[],outputProperties:[],description:"",customAttributes:{}},t=e.inputProperties.filter((e=>e.category)).map((e=>e.category)).distinct(),s=e.inputProperties.filter((e=>!e.category||0==e.category.length)),o=this.activityModel||{type:"",activityId:"",outcomes:[],properties:[],propertyStorageProviders:{}},n=this.t;let r=[];s.length>0&&r.push({tabId:"properties",tabName:n("Tabs.Properties.Name"),renderContent:()=>this.renderPropertiesTab(o)});for(const a of t)r.push({tabId:"categories",tabName:a,renderContent:()=>this.renderCategoryTab(o,e,a)});r.push({tabId:"common",tabName:n("Tabs.Common.Name"),renderContent:()=>this.renderCommonTab(o)}),r.push({tabId:"storage",tabName:n("Tabs.Storage.Name"),renderContent:()=>this.renderStorageTab(o,e)}),this.renderProps={activityDescriptor:e,activityModel:o,propertyCategories:t,defaultProperties:s,tabs:r,selectedTabName:this.renderProps.selectedTabName},await a.emit(i.ActivityEditor.Rendering,this,this.renderProps);let l=this.renderProps.selectedTabName;r=this.renderProps.tabs,l||(this.renderProps.selectedTabName=r[0].tabName),r.findIndex((e=>e.tabName===l))<0&&(this.renderProps.selectedTabName=l=r[0].tabName)}async componentDidRender(){await a.emit(i.ActivityEditor.Rendered,this,this.renderProps)}render(){return t("form",{onChange:this.onChange,ref:e=>this.formElement=e},t("elsa-flyout-panel",{autoExpand:!0,silent:!0,updateCounter:this.updateCounter},this.renderProps.tabs.map((e=>[t("elsa-tab-header",{tab:e.tabName,slot:"header"},e.tabName),t("elsa-tab-content",{tab:e.tabName,slot:"content"},t("div",{class:"elsa-pt-4 elsa-ml-1"},t("elsa-control",{content:e.renderContent()})))]))))}renderStorageTab(e,a){const i=this.formContext;let s=this.workflowStorageDescriptors.map((e=>({value:e.name,text:e.displayName}))),o=a.outputProperties.filter((e=>!e.disableWorkflowProviderSelection)),n=a.inputProperties.filter((e=>!e.disableWorkflowProviderSelection));s=[{value:null,text:"Default"},...s];const c=function(t){const a=t.name,o=`propertyStorageProviders.${a}`;return p(i,o,a,e.propertyStorageProviders[a],s,null,o)};return t("div",{class:"elsa-space-y-8 elsa-w-full"},r("Workflow Context"),l(i,"loadWorkflowContext","Load Workflow Context",e.loadWorkflowContext,"When enabled, this will load the workflow context into memory before executing this activity.","loadWorkflowContext"),l(i,"saveWorkflowContext","Save Workflow Context",e.saveWorkflowContext,"When enabled, this will save the workflow context back into storage after executing this activity.","saveWorkflowContext"),r("Workflow Instance"),l(i,"persistWorkflow","Save Workflow Instance",e.persistWorkflow,"When enabled, this will save the workflow instance back into storage right after executing this activity.","persistWorkflow"),Object.keys(o).length>0?[r("Activity Output","Configure the desired storage for each output property of this activity."),o.map(c)]:void 0,Object.keys(n).length>0?[r("Activity Input","Configure the desired storage for each input property of this activity."),n.map(c)]:void 0)}renderCommonTab(e){const a=this.formContext,i=this.t;return t("div",{class:"elsa-space-y-8 elsa-w-full"},m(a,"name",i("Tabs.Common.Fields.Name.Label"),e.name,i("Tabs.Common.Fields.Name.Hint"),"activityName"),m(a,"displayName",i("Tabs.Common.Fields.DisplayName.Label"),e.displayName,i("Tabs.Common.Fields.DisplayName.Hint"),"activityDisplayName"),c(a,"description",i("Tabs.Common.Fields.Description.Label"),e.description,i("Tabs.Common.Fields.Description.Hint"),"activityDescription"))}renderPropertiesTab(e){const a=this.renderProps.defaultProperties;if(0!=a.length)return t("div",{key:`activity-settings:${e.activityId}`,class:"elsa-grid elsa-grid-cols-1 elsa-gap-y-6 elsa-gap-x-4 sm:elsa-grid-cols-6"},a.map((t=>this.renderPropertyEditor(e,t))))}renderCategoryTab(e,a,i){const s=a.inputProperties.filter((e=>e.category==i));return t("div",{key:`activity-settings:${e.activityId}:${i}`,class:"elsa-grid elsa-grid-cols-1 elsa-gap-y-6 elsa-gap-x-4 sm:elsa-grid-cols-6"},s.map((t=>this.renderPropertyEditor(e,t))))}renderPropertyEditor(e,a){const i=`activity-property-input:${e.activityId}:${a.name}`,o=s.display(e,a,this.onChange);return t("elsa-control",{key:i,id:`${a.name}Control`,class:"sm:elsa-col-span-6",content:o})}};export{b as elsa_activity_editor_panel}